(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{449:function(t,a,r){"use strict";r.r(a);var e=r(3),_=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),a("p",[t._v("今天在整理各个通道异步通知逻辑的时候，有一些记的不太清楚了，所以顺便再确认一轮儿，记录下来。")]),t._v(" "),a("h2",{attrs:{id:"什么是条码付和扫码付"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是条码付和扫码付"}},[t._v("#")]),t._v(" 什么是条码付和扫码付")]),t._v(" "),a("ul",[a("li",[t._v("条码付：即用户被扫，商家使用扫码设备扫描用户的二维码发起的付款。")]),t._v(" "),a("li",[t._v("扫码付：即用户主扫，由用户扫描商户的二维码发起的付款。")])]),t._v(" "),a("h2",{attrs:{id:"常见支付通道异步通知逻辑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见支付通道异步通知逻辑"}},[t._v("#")]),t._v(" 常见支付通道异步通知逻辑")]),t._v(" "),a("h3",{attrs:{id:"_1-支付宝"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-支付宝"}},[t._v("#")]),t._v(" 1. 支付宝")]),t._v(" "),a("ul",[a("li",[t._v("扫码付会有异步通知，触发条件：支付成功。")]),t._v(" "),a("li",[t._v("条码付没有异步通知，如果是支付中，如果主动轮询去查（跟技术支持确认过逻辑）")])]),t._v(" "),a("p",[t._v("文档地址："),a("a",{attrs:{href:"https://opendocs.alipay.com/open/194/103296",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://opendocs.alipay.com/open/194/103296"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"_2-微信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-微信"}},[t._v("#")]),t._v(" 2. 微信")]),t._v(" "),a("ul",[a("li",[t._v("扫码付有异步通知。")]),t._v(" "),a("li",[t._v("条码付没有异步通知。")])]),t._v(" "),a("p",[t._v("针对条码付的支付中状态，文档描述：“**验密支付流程：**场景交互与免密模式相同，不同的是在商户调用【"),a("a",{attrs:{href:"https://pay.weixin.qq.com/wiki/doc/api/micropay.php?chapter=9_10&index=1",target:"_blank",rel:"noopener noreferrer"}},[t._v("付款码支付API"),a("OutboundLink")],1),t._v("】发起支付请求之后，微信支付后台提示用户输入密码确认支付，接口同步返回USERPAYING状态，商户系统再轮询调用查询订单接口来确认当前用户是否已经支付成功。”")]),t._v(" "),a("p",[t._v("微信文档地址："),a("a",{attrs:{href:"https://pay.weixin.qq.com/wiki/doc/api/micropay.php?chapter=5_4",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://pay.weixin.qq.com/wiki/doc/api/micropay.php?chapter=5_4"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"_3-乐刷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-乐刷"}},[t._v("#")]),t._v(" 3. 乐刷")]),t._v(" "),a("ul",[a("li",[t._v("条码付和扫码付都有异步通知，在成功后通知，触发条件：支付成功。")])]),t._v(" "),a("p",[t._v("文档地址："),a("a",{attrs:{href:"https://www.yuque.com/leshuazf/doc/zhifujiaoyi#93D6z",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.yuque.com/leshuazf/doc/zhifujiaoyi#93D6z"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"推荐操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#推荐操作"}},[t._v("#")]),t._v(" 推荐操作")]),t._v(" "),a("p",[t._v("建议不管是条码付还是扫码付，都应该增加主动轮询逻辑，以防止异步通知延迟而带来的不必要麻烦。")]),t._v(" "),a("p",[t._v("另外注意一点："),a("strong",[t._v("有时候异步通知甚至比同步返回还要先到达，需做好逻辑处理。")])])])}),[],!1,null,null,null);a.default=_.exports}}]);